{"remainingRequest":"/Users/apple/xiaomi-mall-mobile/web/node_modules/babel-loader/lib/index.js!/Users/apple/xiaomi-mall-mobile/web/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/apple/xiaomi-mall-mobile/web/node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!/Users/apple/xiaomi-mall-mobile/web/src/views/MiCategory.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/apple/xiaomi-mall-mobile/web/src/views/MiCategory.vue","mtime":1637193421569},{"path":"/Users/apple/xiaomi-mall-mobile/web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/apple/xiaomi-mall-mobile/web/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/apple/xiaomi-mall-mobile/web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/apple/xiaomi-mall-mobile/web/node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2guanMiOwppbXBvcnQgeyBnZXRDYXRlZ29yeSB9IGZyb20gJ0AvYXBpL2NhdGVnb3J5JzsKaW1wb3J0IENhdGVnb3J5R3JvdXAgZnJvbSAnQC9jb21wb25lbnRzL0NhdGVnb3J5R3JvdXAudnVlJzsgLy8gaW1wb3J0IE1pU2VhcmNoIGZyb20gJ0AvY29tcG9uZW50cy9NaVRpdGxlLnZ1ZScKLy8gaW1wb3J0IGJ1cyBmcm9tICdAL3V0aWwvYnVzLmpzJwovLyBpbXBvcnQgUGFnZUZvb3RlciBmcm9tICdAL2NvbXBvbmVudHMvUGFnZUZvb3Rlci52dWUnCgpleHBvcnQgZGVmYXVsdCB7CiAgY29tcG9uZW50czogewogICAgQ2F0ZWdvcnlHcm91cDogQ2F0ZWdvcnlHcm91cCAvLyBNaVNlYXJjaAogICAgLy8gUGFnZUZvb3RlcgoKICB9LAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBjYXRlZ29yeUxpc3Q6IG51bGwsCiAgICAgIGN1ckluZGV4OiAwLAogICAgICAvLyBsb2FkaW5nOiB0cnVlLAogICAgICBvZmZzZXRUb3A6IFtdLAogICAgICBzY3JvbGxUaW1lcjogbnVsbAogICAgfTsKICB9LAogIGJlZm9yZVJvdXRlRW50ZXI6IGZ1bmN0aW9uIGJlZm9yZVJvdXRlRW50ZXIodG8sIGZyb20sIG5leHQpIHsKICAgIC8vIEp1ZGdlIHdoZXRoZXIgdGhlIHJvdXRlciBpcyByZWZyZXNoZWQgb3Igc3dpdGNoZWQKICAgIGlmIChmcm9tLm5hbWUpIHsKICAgICAgLy8gcmVmcmVzaAogICAgICBnZXRDYXRlZ29yeSgpLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgIGlmIChyZXMuc3RhdHVzID09PSAyMDApIHsKICAgICAgICAgIG5leHQoZnVuY3Rpb24gKHZtKSB7CiAgICAgICAgICAgIHJldHVybiB2bS5zZXROYXZMaXN0KHJlcy5kYXRhLmxpc3RzKTsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9IGVsc2UgewogICAgICAvLyBzd2l0Y2gKICAgICAgbmV4dChmdW5jdGlvbiAodm0pIHsKICAgICAgICByZXR1cm4gdm0uZ2V0Q2F0ZWdvcnlMaXN0KCk7CiAgICAgIH0pOwogICAgfQogIH0sCiAgLy8gY3JlYXRlZCgpIHsKICAvLyAgIHRoaXMuZ2V0Q2F0ZWdvcnlMaXN0KCkKICAvLyB9LAogIGRlc3RvcnllZDogZnVuY3Rpb24gZGVzdG9yeWVkKCkgewogICAgdGhpcy4kTlByb2dyZXNzLnJlbW92ZSgpOwogIH0sCiAgLy8gdW5tb3VudGVkKCkgewogIC8vICAgdGhpcy4kTlByb2dyZXNzLnJlbW92ZSgpCiAgLy8gfSwKICBtZXRob2RzOiB7CiAgICBnZXRDYXRlZ29yeUxpc3Q6IGZ1bmN0aW9uIGdldENhdGVnb3J5TGlzdCgpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIGdldENhdGVnb3J5KCkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgaWYgKHJlcy5zdGF0dXMgPT09IDIwMCkgewogICAgICAgICAgX3RoaXMuc2V0TmF2TGlzdChyZXMuZGF0YS5saXN0cyk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBzZXROYXZMaXN0OiBmdW5jdGlvbiBzZXROYXZMaXN0KHJlcykgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHRoaXMuJE5Qcm9ncmVzcy5kb25lKCk7CiAgICAgIHRoaXMuY2F0ZWdvcnlMaXN0ID0gcmVzOwogICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ3NldFZpZXdMb2FkaW5nJywgZmFsc2UpOyAvLyB0aGlzLmxvYWRpbmcgPSBmYWxzZQoKICAgICAgLyoqDQogICAgICAgKiB2dWUyLngNCiAgICAgICAqLwogICAgICAvLyBidXMuJGVtaXQoJ2xvYWRpbmcnLCBmYWxzZSkKCiAgICAgIC8qKg0KICAgICAgICogdnVlMy54DQogICAgICAgKi8KICAgICAgLy8gbG9jYWwgaW52b2tlCiAgICAgIC8vIGJ1cy5lbWl0KCdsb2FkaW5nJywgZmFsc2UpCiAgICAgIC8vIGdsb2JhbCBpbnZva2UKICAgICAgLy8gdGhpcy4kYnVzLmVtaXQoJ2xvYWRpbmcnLCBmYWxzZSkKICAgICAgLy8gSGFuZGxlIHNjcm9sbAoKICAgICAgdGhpcy4kbmV4dFRpY2soZnVuY3Rpb24gKCkgewogICAgICAgIF90aGlzMi5jYXRlZ29yeUxpc3QuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSwgaW5kZXgpIHsKICAgICAgICAgIF90aGlzMi5vZmZzZXRUb3AucHVzaChfdGhpczIuJHJlZnNbJ2NhdGVnb3J5JyArIGluZGV4XS5vZmZzZXRUb3ApOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0sCiAgICBoYW5kbGVDaGFuZ2VJbmRleDogZnVuY3Rpb24gaGFuZGxlQ2hhbmdlSW5kZXgoaW5kZXgpIHsKICAgICAgdGhpcy5jdXJJbmRleCA9IGluZGV4OwogICAgICB2YXIgbGlzdFdyYXBEb20gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubGlzdC13cmFwJyk7CiAgICAgIGxpc3RXcmFwRG9tLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIHRoaXMuc2Nyb2xsSGFuZGxlcik7CiAgICAgIGxpc3RXcmFwRG9tLnNjcm9sbFRvKDAsIHRoaXMub2Zmc2V0VG9wW2luZGV4XSk7CiAgICB9LAogICAgaGFuZGxlV3JhcFNjcm9sbDogZnVuY3Rpb24gaGFuZGxlV3JhcFNjcm9sbCgpIHsKICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmxpc3Qtd3JhcCcpLmFkZEV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIHRoaXMuc2Nyb2xsSGFuZGxlcik7CiAgICB9LAogICAgc2Nyb2xsSGFuZGxlcjogZnVuY3Rpb24gc2Nyb2xsSGFuZGxlcigpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CgogICAgICBjbGVhclRpbWVvdXQodGhpcy5zY3JvbGxUaW1lcik7CiAgICAgIHRoaXMuc2Nyb2xsVGltZXIgPSBudWxsOwogICAgICB0aGlzLnNjcm9sbFRpbWVyID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIHNjcm9sbFRvcCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5saXN0LXdyYXAnKS5zY3JvbGxUb3A7CiAgICAgICAgdmFyIGxlbiA9IF90aGlzMy5vZmZzZXRUb3AubGVuZ3RoOwoKICAgICAgICBmb3IgKHZhciBpbmRleCA9IDA7IGluZGV4IDwgbGVuOyArK2luZGV4KSB7CiAgICAgICAgICBpZiAoc2Nyb2xsVG9wID49IF90aGlzMy5vZmZzZXRUb3BbaW5kZXhdICYmIHNjcm9sbFRvcCA8IF90aGlzMy5vZmZzZXRUb3BbaW5kZXggKyAxXSkgewogICAgICAgICAgICBfdGhpczMuY3VySW5kZXggPSBpbmRleDsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCAxMDApOwogICAgfQogIH0KfTs="},{"version":3,"sources":["/Users/apple/xiaomi-mall-mobile/web/src/views/MiCategory.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <div class=\"app-shell\">\r\n    <mi-title title=\"分类\"/>\r\n    <!-- <div v-if=\"loading\">\r\n      <span>Loading . . .</span>\r\n    </div> -->\r\n    <!-- <div v-else class=\"app-view-wrapper\"> -->\r\n    <div class=\"app-view-wrapper\">\r\n      <div class=\"container app-view app-view-with-header app-view-with-footer\">\r\n        <div class=\"list-navbar\">\r\n          <ul>\r\n            <li\r\n              v-for=\"(list,index) in categoryList\"\r\n              :key=\"list.category_id\"\r\n              :class=\"index == curIndex ? 'active' : ''\"\r\n              @click=\"handleChangeIndex(index)\"\r\n            >\r\n              <a>\r\n                <span>{{list.category_name}}</span>\r\n              </a>\r\n            </li>\r\n          </ul>\r\n        </div>\r\n        <div class=\"list-wrap\" @touchstart=\"handleWrapScroll\">\r\n          <div\r\n            v-for=\"(list, index) in categoryList\"\r\n            :key=\"list.category_id\"\r\n            :ref=\"'category'+index\"\r\n            class=\"list-item\"\r\n          >\r\n            <div class=\"component-list-main\">\r\n              <div class=\"cells_auto_fill\" index =\"0\">\r\n                <a class=\"exposure items\">\r\n                  <img :src=\"list.category_img\" lazy=\"loaded\">\r\n                </a>\r\n              </div>\r\n              <template\r\n                v-for=\"item in list.category_list\"\r\n                :key=\"item.id\"\r\n              >\r\n                <div\r\n                  class=\"category_title\"\r\n                >\r\n                  <span>{{item.category_title}}</span>\r\n                </div>\r\n                <category-group :products=\"item.category_group\" />\r\n              </template>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <page-footer/>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { getCategory } from '@/api/category'\r\nimport CategoryGroup from '@/components/CategoryGroup.vue'\r\n// import MiSearch from '@/components/MiTitle.vue'\r\n// import bus from '@/util/bus.js'\r\n// import PageFooter from '@/components/PageFooter.vue'\r\n\r\nexport default {\r\n  components: {\r\n    CategoryGroup\r\n    // MiSearch\r\n    // PageFooter\r\n  },\r\n  data() {\r\n    return {\r\n      categoryList: null,\r\n      curIndex: 0,\r\n      // loading: true,\r\n      offsetTop: [],\r\n      scrollTimer: null\r\n    }\r\n  },\r\n  beforeRouteEnter(to, from, next) {\r\n    // Judge whether the router is refreshed or switched\r\n    if(from.name) {\r\n      // refresh\r\n      getCategory().then(res => {\r\n        if(res.status === 200) {\r\n          next(vm => vm.setNavList(res.data.lists))\r\n        }\r\n      })\r\n    } else {\r\n      // switch\r\n      next(vm => vm.getCategoryList())\r\n    }\r\n  },\r\n  // created() {\r\n  //   this.getCategoryList()\r\n  // },\r\n  destoryed() {\r\n    this.$NProgress.remove()\r\n  },\r\n  // unmounted() {\r\n  //   this.$NProgress.remove()\r\n  // },\r\n  methods: {\r\n    getCategoryList() {\r\n      getCategory().then(res => {\r\n        if(res.status === 200) {\r\n          this.setNavList(res.data.lists)\r\n        }\r\n      })\r\n    },\r\n    setNavList(res) {\r\n      this.$NProgress.done()\r\n      this.categoryList = res\r\n      this.$store.commit('setViewLoading', false)\r\n      // this.loading = false\r\n      /**\r\n       * vue2.x\r\n       */\r\n      // bus.$emit('loading', false)\r\n\r\n      /**\r\n       * vue3.x\r\n       */\r\n      // local invoke\r\n      // bus.emit('loading', false)\r\n\r\n      // global invoke\r\n      // this.$bus.emit('loading', false)\r\n\r\n      // Handle scroll\r\n      this.$nextTick(() => {\r\n        this.categoryList.forEach((item, index) => {\r\n          this.offsetTop.push(this.$refs['category' + index].offsetTop)\r\n        })\r\n      })\r\n    },\r\n    handleChangeIndex(index) {\r\n      this.curIndex = index\r\n      const listWrapDom = document.querySelector('.list-wrap')\r\n      listWrapDom.removeEventListener('scroll', this.scrollHandler)\r\n      listWrapDom.scrollTo(0, this.offsetTop[index])\r\n    },\r\n    handleWrapScroll() {\r\n      document.querySelector('.list-wrap').addEventListener('scroll', this.scrollHandler)\r\n    },\r\n    scrollHandler() {\r\n      clearTimeout(this.scrollTimer)\r\n      this.scrollTimer = null\r\n      this.scrollTimer = setTimeout(() => {\r\n        const scrollTop = document.querySelector('.list-wrap').scrollTop\r\n        const len = this.offsetTop.length\r\n        for(let index = 0; index < len; ++index) {\r\n          if(scrollTop >= this.offsetTop[index] && scrollTop < this.offsetTop[index + 1]) {\r\n            this.curIndex = index\r\n            break\r\n          }\r\n        }\r\n      }, 100)\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.container {\r\n  margin-right: auto;\r\n  margin-left: auto;\r\n  flex-basis: 100%;\r\n\r\n  .list-navbar {\r\n    position: fixed;\r\n    top: 40px;\r\n    bottom: 40px;\r\n    left: 0;\r\n    width: 80px;\r\n    border-right: 1px solid #efefef;\r\n    overflow: hidden;\r\n\r\n    ul {\r\n      z-index: 90;\r\n      position: absolute;\r\n      top: 0;\r\n      bottom: 0;\r\n      left: 0;\r\n      /* hide scroll bar */\r\n      right: -6px;\r\n      padding: 8px 6px 8px 0px;\r\n      background: #fefefe;\r\n      overflow-y: auto;\r\n      -webkit-overflow-scrolling: touch;\r\n\r\n      li {\r\n        font-size: 18px;\r\n        height: 50px;\r\n        line-height: 50px;\r\n        overflow: hidden;\r\n        text-align: center;\r\n        -webkit-tap-highlight-color: rgba(0, 0, 0, 0);\r\n        transition: transform 0.1s linear;\r\n        transform-origin: center center;\r\n        transform: scale(0.76);\r\n\r\n        span {\r\n          display: inline-block;\r\n        }\r\n      }\r\n\r\n      li.active {\r\n        color: #fb7d34;\r\n        transform: scale(1);\r\n      }\r\n    }\r\n  }\r\n\r\n  .list-wrap {\r\n    position: absolute;\r\n    left: 80px;\r\n    right: 0;\r\n    top: 59px;\r\n    bottom: 50px;\r\n    padding: 2px 16px;\r\n    overflow: auto;\r\n\r\n    .component-list-main {\r\n      .cells_auto_fill {\r\n        .items {\r\n          height: auto!important;\r\n          display: block;\r\n\r\n          img {\r\n            width: 260px;\r\n            height: 104px;\r\n            background-color: #f2f2f2;\r\n          }\r\n        }\r\n      }\r\n\r\n      .category_title {\r\n        background: #fff;\r\n        font-size: 16px;\r\n        text-align: center;\r\n        font-weight: 400;\r\n        margin-top: 10px;\r\n        height: 66px;\r\n        line-height: 66px;\r\n        overflow: hidden;\r\n\r\n        span {\r\n          position: relative;\r\n        }\r\n\r\n        span::after, span::before{\r\n          content: \"\";\r\n          position: absolute;\r\n          top: 50%;\r\n          left: 0;\r\n          width: 30px;\r\n          border-top: 1px solid #e0e0e0;\r\n          transform: translate3d(-150%,-50%,0);\r\n        }\r\n\r\n        span::after {\r\n          left: auto;\r\n          right: 0;\r\n          transform: translate3d(150%,-50%,0);\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n"],"sourceRoot":""}]}