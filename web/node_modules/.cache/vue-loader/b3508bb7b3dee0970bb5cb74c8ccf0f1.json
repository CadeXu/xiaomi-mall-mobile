{"remainingRequest":"/Volumes/HD/xiaoMi/FE/xiaomi-mall-mobile/node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!/Volumes/HD/xiaoMi/FE/xiaomi-mall-mobile/src/views/MiAddress/MiAddressEdit.vue?vue&type=style&index=0&id=12ec4855&lang=scss&scoped=true","dependencies":[{"path":"/Volumes/HD/xiaoMi/FE/xiaomi-mall-mobile/src/views/MiAddress/MiAddressEdit.vue","mtime":1637847564973},{"path":"/Volumes/HD/xiaoMi/FE/xiaomi-mall-mobile/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Volumes/HD/xiaoMi/FE/xiaomi-mall-mobile/node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js","mtime":499162500000},{"path":"/Volumes/HD/xiaoMi/FE/xiaomi-mall-mobile/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Volumes/HD/xiaoMi/FE/xiaomi-mall-mobile/node_modules/sass-loader/dist/cjs.js","mtime":499162500000},{"path":"/Volumes/HD/xiaoMi/FE/xiaomi-mall-mobile/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Volumes/HD/xiaoMi/FE/xiaomi-mall-mobile/node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci5hZGRyZXNzLW1hbmFnZXIgewogIC51aS1saXN0IHsKICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsKCiAgICAudWktbGlzdC1pdGVtIHsKICAgICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkICNmNmY2ZjY7CiAgICAgIGZvbnQtc2l6ZTogMTRweDsKICAgICAgb3ZlcmZsb3c6IGhpZGRlbjsKICAgICAgYmFja2dyb3VuZDogI2ZmZjsKICAgICAgcGFkZGluZzogMTBweCAxNXB4OwogICAgICBkaXNwbGF5OiBmbGV4OwogICAgICBkaXNwbGF5OiAtd2Via2l0LWJveDsKICAgICAgYm94LWFsaWduOiBjZW50ZXI7CiAgICAgIC13ZWJraXQtYm94LWFsaWduOiBjZW50ZXIKICAgIH0KCiAgICAudWktaW5wdXQgewogICAgICBib3JkZXI6IDA7CiAgICAgIGJveC1mbGV4OiAxOwogICAgICBvdmVyZmxvdzogaGlkZGVuOwogICAgICBmb250LXNpemU6IDEycHg7CiAgICAgIHdpZHRoOiAxMDAlOwoKICAgICAgaW5wdXQgewogICAgICBwYWRkaW5nOiA5cHggMTVweDsKICAgICAgd2lkdGg6IDEwMCU7CiAgICAgIC13ZWJraXQtYm94LWZsZXg6IDE7CiAgICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7CiAgICAgIGZvbnQtc2l6ZTogMTRweDsKICAgICAgYm9yZGVyOiAwOwogICAgICB0ZXh0LWRlY29yYXRpb246IG5vbmU7CiAgICAgIG91dGxpbmU6IDA7CiAgICAgIHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7CiAgICB9CiAgICB9CgogICAgLnVpLWNlbGwgewogICAgICBkaXNwbGF5OiBibG9jazsKICAgICAgYm94LWZsZXg6IDE7CiAgICAgIC13ZWJraXQtYm94LWZsZXg6IDE7CiAgICAgIHdpZHRoOiAxMDAlOwogICAgICB0ZXh0LWFsaWduOiByaWdodDsKICAgIH0KICB9Cn0KClt0eXBlPWNoZWNrYm94XSwgW3R5cGU9cmFkaW9dIHsKICBib3gtc2l6aW5nOiBib3JkZXItYm94OwogIHBhZGRpbmc6IDA7Cn0KCi5hZGQgewogIHBvc2l0aW9uOiBmaXhlZDsKICBib3R0b206IDA7CiAgbGVmdDogMDsKICByaWdodDogMDsKICBiYWNrZ3JvdW5kOiAjZmZmOwogIHotaW5kZXg6IDE7CgogIHNwYW4gewogICAgZm9udC1zaXplOiAxNXB4OwogICAgY29sb3I6ICNmZmY7CiAgfQp9Cg=="},{"version":3,"sources":["/Volumes/HD/xiaoMi/FE/xiaomi-mall-mobile/src/views/MiAddress/MiAddressEdit.vue"],"names":[],"mappings":"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","file":"/Volumes/HD/xiaoMi/FE/xiaomi-mall-mobile/src/views/MiAddress/MiAddressEdit.vue","sourceRoot":"","sourcesContent":["<template>\n  <div class=\"app-shell app-shell-bottom-navigation\">\n    <div class=\"app-view-wrapper\">\n\n      <MiTitle :title=\"title\" :show-search-icon=\"false\"/>\n\n      <div class=\"container app-view app-view-with-header\">\n        <div class=\"page-wrap\">\n          <div class=\"address-manager\">\n            <div class=\"address-manager-edit\">\n              <ul class=\"ui-list\">\n\n                <li class=\"ui-list-item\">\n                  <div class=\"label\">收货人：</div>\n                  <div class=\"ui-input\">\n                    <input\n                      v-model.trim=\"addressInfo.consignee\"\n                      placeholder=\"真实姓名\"\n                      name=\"consignee\"\n                      maxlength=\"15\"\n                      type=\"text\"\n                      autocomplete=\"off\"\n                    >\n                  </div>\n                </li>\n\n                <li class=\"ui-list-item\">\n                  <div class=\"label\">手机号码：</div>\n                  <div class=\"ui-input\">\n                    <input\n                      v-model.trim.number=\"addressInfo.tel\"\n                      :placeholder=\"telplaceholder\"\n                      name=\"tel\"\n                      maxlength=\"11\"\n                      id=\"tel\"\n                      type=\"tel\"\n                      autocomplete=\"off\"\n                    >\n                  </div>\n                </li>\n\n                <li class=\"ui-list-item\">\n                  <div class=\"label\">所在地区：</div>\n                  <div class=\"ui-input\" @click=\"showRegions=true\">\n                    <input\n                      :value=\"addressStr\"\n                      placeholder=\"省 市 区 街道信息\"\n                      name=\"pcd\"\n                      maxlength=\"20\"\n                      type=\"text\"\n                      readonly=\"readonly\"\n                    >\n                  </div>\n                </li>\n\n                <li class=\"ui-list-item\">\n                  <div class=\"label\">详细地址：</div>\n                  <div class=\"ui-input\">\n                    <input\n                      v-model.trim=\"addressInfo.address\"\n                      placeholder=\"详细地址\"\n                      id=\"address\"\n                      name=\"address\"\n                      maxlength=\"40\"\n                      type=\"text\"\n                      autocomplete=\"off\"\n                    >\n                  </div>\n                </li>\n\n                <li class=\"ui-list-item\">\n                  <div class=\"label\">设置为默认地址</div>\n                  <label class=\"ui-cell\">\n                    <input\n                      name=\"is_default\"\n                      type=\"checkbox\"\n                      v-model=\"addressInfo.is_default\"\n                    >\n                  </label>\n                </li>\n              </ul>\n            </div>\n          </div>\n        </div>\n\n        <div class=\"add\">\n          <a class=\"btn ui-button ui-button-active\" @click=\"submit\">\n            <span>保存地址</span>\n          </a>\n        </div>\n\n        <MiAddressAll v-model:value=\"showRegions\" @region=\"changeRegion\"/>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport MiAddressAll from '@/components/MiAddressAll.vue'\n// import { addressDetail, addressAdd, addressSave } from '@/api/address.js'\nimport Address from '@/api/addressService'\nimport Dialog from '@/components/dialog'\n\nexport default {\n  components: {\n    MiAddressAll\n  },\n  data() {\n    return {\n      title: '',\n      showRegions: false,\n      addressInfo: {\n        consignee: '',\n        tel: '',\n        province: '',\n        province_id: '',\n        city: '',\n        city_id: '',\n        district: '',\n        district_id: '',\n        area: '',\n        area_id: '',\n        address: '',\n        is_default: false\n      },\n      telplaceholder: '手机号'\n    }\n  },\n  computed: {\n    addressStr() {\n      let info = this.addressInfo\n      return `${info.province} ${info.city} ${info.district} ${info.area}`.trim()\n    }\n  },\n  beforeRouteEnter(to, from, next) {\n    let id = to.query.address_id\n    if(id) {\n      // Edit\n      if(from.name) {\n        Address.detail(id).then(res => {\n          if(res.status === 200) {\n            next(vm => vm.setAddress(res))\n          }\n        })\n      } else {\n        next(vm => vm.getAddress())\n      }\n    } else {\n      // Add new one\n      next()\n    }\n  },\n  created() {\n    if(this.$route.query.address_id) {\n      // Edit\n      this.title = '编辑地址'\n    } else {\n      // Add new one\n      this.title = '新建地址'\n      this.$store.commit('setViewLoading', false)\n      this.$NProgress.done()\n    }\n  },\n  methods: {\n    getAddress() {\n      Address.detail(this.$route.query.address_id).then(res => {\n        if(res.status === 200) {\n          this.setAddress(res)\n        }\n      })\n    },\n    setAddress(res) {\n      this.$store.commit('setViewLoading', false)\n      this.$NProgress.done()\n\n      let info = res.data\n      info.is_default = info.is_default === 1\n\n      this.addressInfo = info\n      this.telplaceholder = info.tel\n      this.addressInfo.tel = ''\n    },\n    changeRegion(region) {\n      this.addressInfo = Object.assign({}, this.addressInfo, region)\n    },\n    popupDialog(promptInfo) {\n      Dialog.alert({\n        message: promptInfo\n      })\n    },\n    submit() {\n      // Verify\n      let ai = this.addressInfo\n\n      // verify consignee\n      if(!ai.consignee) {\n        // Dialog.alert({\n        //   message: '请输入收货人姓名'\n        // })\n        this.popupDialog('请输入收货人姓名')\n        return\n      }\n\n      // verify telphone\n      const reg = /^((1[3-9][0-9])+\\d{8})$/\n      if(this.$route.query.address_id) {\n        if(ai.tel && !reg.test(ai.tel)) {\n          // Dialog.alert({\n          //   message: '请输入11位手机号码'\n          // })\n          this.popupDialog('请输入11位手机号码')\n          return\n        }\n      } else {\n        if(!ai.tel || !reg.test(ai.tel)) {\n          // Dialog.alert({\n          //   message: '请输入11位手机号码'\n          // })\n          this.popupDialog('请输入11位手机号码')\n          return\n        }\n      }\n\n      // verify area\n      if(!this.addressStr) {\n        // Dialog.alert({\n        //   message: '请选择所在地区'\n        // })\n        this.popupDialog('请选择所在地区')\n        return\n      }\n\n      // verify address detail\n      if(!ai.address) {\n        // Dialog.alert({\n        //   message: '请输入详细地址'\n        // })\n        this.popupDialog('请输入详细地址')\n        return\n      }\n\n      // verify address length\n      let len = ai.address.length\n      if(len < 5 || len > 120) {\n        // Dialog.alert({\n        //   message: '抱歉，详细地址不能少于5个字，不能多于120个字'\n        // })\n        this.popupDialog('抱歉，详细地址不能少于5个字，不能多于120个字')\n        return\n      }\n\n      this.addressInfo.is_default = this.addressInfo.is_default ? 1 : 2\n\n      let api = this.$route.query.address_id ? 'save' : 'add'\n      Address[api](this.addressInfo).then(res => {\n        if(res.status === 200) {\n          this.$router.go(-1)\n        }\n      })\n      // if(this.$route.query.address_id) {\n      //   // Edit\n      //   Address.save(this.addressInfo).then(res => {\n      //     if(res.status === 200) {\n      //       this.$router.go(-1)\n      //     }\n      //   })\n      // } else {\n      //   // Add new one\n      //   Address.add(this.addressInfo).then(res => {\n      //     if(res.status === 200) {\n      //       this.$router.go(-1)\n      //     }\n      //   })\n      // }\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.address-manager {\n  .ui-list {\n    position: relative;\n\n    .ui-list-item {\n      border-bottom: 1px solid #f6f6f6;\n      font-size: 14px;\n      overflow: hidden;\n      background: #fff;\n      padding: 10px 15px;\n      display: flex;\n      display: -webkit-box;\n      box-align: center;\n      -webkit-box-align: center\n    }\n\n    .ui-input {\n      border: 0;\n      box-flex: 1;\n      overflow: hidden;\n      font-size: 12px;\n      width: 100%;\n\n      input {\n      padding: 9px 15px;\n      width: 100%;\n      -webkit-box-flex: 1;\n      box-sizing: border-box;\n      font-size: 14px;\n      border: 0;\n      text-decoration: none;\n      outline: 0;\n      vertical-align: middle;\n    }\n    }\n\n    .ui-cell {\n      display: block;\n      box-flex: 1;\n      -webkit-box-flex: 1;\n      width: 100%;\n      text-align: right;\n    }\n  }\n}\n\n[type=checkbox], [type=radio] {\n  box-sizing: border-box;\n  padding: 0;\n}\n\n.add {\n  position: fixed;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  background: #fff;\n  z-index: 1;\n\n  span {\n    font-size: 15px;\n    color: #fff;\n  }\n}\n</style>\n"]}]}