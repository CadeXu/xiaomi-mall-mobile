(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["cart"],{"4d1a":function(e,t,i){"use strict";var c=i("7a23");Object(c["z"])("data-v-f4261d42");var s={class:"insurance-pop"},n={class:"pop"},a=Object(c["i"])("i",{class:"image-icons iconfont icon-icon-close"},null,-1),o=[a];function r(e,t,i,a,r,l){return Object(c["w"])(),Object(c["h"])("div",s,[Object(c["P"])(Object(c["i"])("div",{class:Object(c["r"])(i.overlayClass),style:Object(c["s"])(i.overlayStyle),onClick:t[0]||(t[0]=function(){return l.clickOverlay&&l.clickOverlay.apply(l,arguments)})},null,6),[[c["M"],i.value&&i.overlay]]),Object(c["l"])(c["b"],{name:i.transition},{default:Object(c["O"])((function(){return[Object(c["P"])(Object(c["i"])("div",n,[Object(c["i"])("div",{class:"close",onClick:t[1]||(t[1]=function(){return l.close&&l.close.apply(l,arguments)})},o),Object(c["D"])(e.$slots,"default",{},void 0,!0)],512),[[c["M"],i.value]])]})),_:3},8,["name"])])}Object(c["x"])();var l={props:{value:{type:Boolean,required:!0,default:!1},overlay:{type:Boolean,default:!0},overlayClass:{type:String,default:"ui-mask"},overlayStyle:{type:Object},closeOnClickOverlay:{type:Boolean,default:!1},transition:{type:String,default:"bottom-up"}},methods:{close:function(){this.$emit("update:value",!1)},clickOverlay:function(){this.closeOnClickOverlay&&this.close()}}},u=(i("cf6f"),i("d959")),d=i.n(u);const f=d()(l,[["render",r],["__scopeId","data-v-f4261d42"]]);t["a"]=f},a434:function(e,t,i){"use strict";var c=i("23e7"),s=i("da84"),n=i("23cb"),a=i("5926"),o=i("07fa"),r=i("7b0b"),l=i("65f0"),u=i("8418"),d=i("1dde"),f=d("splice"),_=s.TypeError,v=Math.max,b=Math.min,p=9007199254740991,m="Maximum allowed length exceeded";c({target:"Array",proto:!0,forced:!f},{splice:function(e,t){var i,c,s,d,f,j,O=r(this),g=o(O),h=n(e,g),I=arguments.length;if(0===I?i=c=0:1===I?(i=0,c=g-h):(i=I-2,c=b(v(a(t),0),g-h)),g+i-c>p)throw _(m);for(s=l(O,c),d=0;d<c;d++)f=h+d,f in O&&u(s,d,O[f]);if(s.length=c,i<c){for(d=h;d<g-c;d++)f=d+c,j=d+i,f in O?O[j]=O[f]:delete O[j];for(d=g;d>g-c+i;d--)delete O[d-1]}else if(i>c)for(d=g-c;d>h;d--)f=d+c-1,j=d+i-1,f in O?O[j]=O[f]:delete O[j];for(d=0;d<i;d++)O[d+h]=arguments[d+2];return O.length=g-c+i,s}})},bd8e:function(e,t,i){},c740:function(e,t,i){"use strict";var c=i("23e7"),s=i("b727").findIndex,n=i("44d2"),a="findIndex",o=!0;a in[]&&Array(1)[a]((function(){o=!1})),c({target:"Array",proto:!0,forced:o},{findIndex:function(e){return s(this,e,arguments.length>1?arguments[1]:void 0)}}),n(a)},cf6f:function(e,t,i){"use strict";i("bd8e")},df33:function(e,t,i){},f0fe:function(e,t,i){"use strict";i("df33")},f733:function(e,t,i){"use strict";i.r(t);var c=i("7a23");Object(c["z"])("data-v-23236370");var s={class:"app-shell app-shell-bottom-navigation"},n={class:"app-view-wrapper"},a={class:"container fluid app-view app-view-with-header app-view-with-footer"},o={class:"page-wrap"},r={key:0,class:"nologin"},l=Object(c["i"])("span",{class:"flex"}," 登录后享受更多优惠 ",-1),u=Object(c["i"])("em",{class:"flex"}," 去登录 ",-1),d={key:1,class:"cart-list"},f={class:"ui-flex align-center justify-center"},_=["onClick"],v=["src"],b={class:"info flex"},p={class:"name"},m={class:"flex"},j={key:0,class:"price-without"},O=Object(c["i"])("span",null,"售价：",-1),g=Object(c["i"])("span",null,"合计：",-1),h={class:"num"},I={class:"xm-input-number"},y=["onClick"],k=Object(c["i"])("i",{class:"iconfont icon-reduce3"},null,-1),w=[k],x={class:"input-num"},C=["onClick"],S=Object(c["i"])("i",{class:"iconfont icon-add"},null,-1),L=[S],E=["onClick"],H=Object(c["i"])("i",{class:"iconfont icon-delete"},null,-1),M=[H],P={key:0,class:"append flex"},N=["onClick"],B={class:"insurance"},T={class:"i1"},A=["src"],J={class:"i2"},X=Object(c["i"])("div",{class:"i3"},[Object(c["i"])("span",null,"选购")],-1),G=Object(c["j"])('<div class="point-box" data-v-23236370><div class="point" data-v-23236370><span class="act act_gift" data-v-23236370>赠品</span><span data-v-23236370>赠小米蓝牙耳机</span></div><div class="point" data-v-23236370><span class="act act_special" data-v-23236370>活动</span><span data-v-23236370>下单立减100元</span></div><div class="point" style="display:none;" data-v-23236370><span class="act act_special" data-v-23236370>包邮</span><span data-v-23236370></span></div><div class="point" data-v-23236370><p data-v-23236370>温馨提示：产品是否购买成功，以最终下单为准，请尽快结算</p></div></div>',1),R={key:2,class:"noitems"},z=Object(c["i"])("span",null,"购物车还是空的",-1),K=Object(c["i"])("em",null,"去逛逛",-1),$={class:"bottom-submit box-flex"},q={class:"price-box flex"},D=Object(c["i"])("br",null,null,-1),U=Object(c["i"])("span",null,"元",-1),V=Object(c["k"])(" 继续购物 "),F=Object(c["i"])("a",{class:"btn flex"},"去结算",-1),Q=Object(c["i"])("div",{class:"h1"},"购买服务",-1),W={class:"max5"},Y={key:0,class:"option-title pt32"},Z=["href"],ee=Object(c["i"])("i",{class:"iconfont icon-question"},null,-1),te=[ee],ie=["onClick"],ce={class:"align-center justify-start layout wrap"},se={class:"btn-bottom align-center justify-canter layout"},ne={class:"flex"};function ae(e,t,i,k,S,H){var ee=Object(c["E"])("mi-title"),ae=Object(c["E"])("router-link"),oe=Object(c["E"])("MiRecommend"),re=Object(c["E"])("MiPop");return Object(c["w"])(),Object(c["h"])("div",s,[Object(c["l"])(ee,{title:"购物车"}),Object(c["i"])("div",n,[Object(c["i"])("div",a,[Object(c["i"])("div",o,[e.isLogin?Object(c["g"])("",!0):(Object(c["w"])(),Object(c["h"])("div",r,[Object(c["l"])(ae,{class:"box-flex align-center justify-space-between",to:{name:"login",query:{redirect:"/cart"}}},{default:Object(c["O"])((function(){return[l,u]})),_:1})])),e.cartList&&e.cartList.length?(Object(c["w"])(),Object(c["h"])("div",d,[Object(c["i"])("ol",null,[(Object(c["w"])(!0),Object(c["h"])(c["a"],null,Object(c["C"])(e.cartList,(function(t,i){return Object(c["w"])(),Object(c["h"])("li",{key:t.goodsId,class:"item"},[Object(c["i"])("div",f,[Object(c["i"])("div",{class:Object(c["r"])(["choose flex",{checked:t.sel_status}]),onClick:function(c){return e.cartSelect(t,i)}},[t.parent_goodsId?Object(c["g"])("",!0):(Object(c["w"])(),Object(c["h"])("i",{key:0,class:Object(c["r"])(["iconfont",t.sel_status?"icon-roundcheckfill":"icon-round"])},null,2))],10,_),Object(c["l"])(ae,{to:{name:"detail",params:{id:t.goodsId}},class:"imgProduct flex"},{default:Object(c["O"])((function(){return[Object(c["i"])("img",{src:t.image_url,lazy:"loaded"},null,8,v)]})),_:2},1032,["to"]),Object(c["i"])("div",b,[Object(c["i"])("p",p,[Object(c["i"])("span",m,Object(c["H"])(t.product_name),1)]),t.price?(Object(c["w"])(),Object(c["h"])("div",j,[O,Object(c["i"])("span",null,Object(c["H"])(t.price)+" 元",1),t.isService?(Object(c["w"])(),Object(c["h"])(c["a"],{key:0},[g,Object(c["i"])("span",null,Object(c["H"])(t.price*t.num)+" 元",1)],64)):Object(c["g"])("",!0)])):Object(c["g"])("",!0),Object(c["i"])("div",h,[Object(c["i"])("div",I,[Object(c["i"])("div",{class:Object(c["r"])(["input-sub",{active:t.num>1&&t.price}]),onClick:function(i){return e.cartEdit(t,-1)}},w,10,y),Object(c["i"])("div",x,[Object(c["i"])("span",null,Object(c["H"])(t.num),1)]),Object(c["i"])("div",{class:Object(c["r"])(["input-add",{active:t.num<t.buy_limit&&t.price}]),onClick:function(i){return e.cartEdit(t,1)}},L,10,C)]),t.price?(Object(c["w"])(),Object(c["h"])("div",{key:0,class:"delete",onClick:function(c){return e.cartDelete(t,i)}},M,8,E)):Object(c["g"])("",!0)])])]),t.sel_status?(Object(c["w"])(),Object(c["h"])("div",P,[(Object(c["w"])(!0),Object(c["h"])(c["a"],null,Object(c["C"])(t.serviceList,(function(i){return Object(c["w"])(),Object(c["h"])("div",{key:i.service_goods_id,onClick:function(i){return e.toCartSelService(t)}},[Object(c["i"])("div",B,[Object(c["i"])("div",T,[Object(c["i"])("img",{src:i.service_image_url,lazy:"loaded"},null,8,A)]),Object(c["i"])("div",J,[Object(c["i"])("span",null,Object(c["H"])(i.service_short_name)+" "+Object(c["H"])(i.service_price)+"元",1)]),X])],8,N)})),128))])):Object(c["g"])("",!0)])})),128))]),G])):(Object(c["w"])(),Object(c["h"])("div",R,[Object(c["l"])(ae,{to:{name:"home"},class:"router-link-active"},{default:Object(c["O"])((function(){return[z,K]})),_:1})])),Object(c["l"])(oe)]),Object(c["i"])("div",$,[Object(c["i"])("div",q,[Object(c["i"])("span",null,"共 "+Object(c["H"])(e.totalNumber)+" 件 金额：",1),D,Object(c["i"])("strong",null,Object(c["H"])(e.totalPrice),1),U]),Object(c["l"])(ae,{to:{name:"category"},class:"btn disable black flex"},{default:Object(c["O"])((function(){return[V]})),_:1}),F]),Object(c["l"])(re,{value:e.showServiceInfo,"onUpdate:value":t[1]||(t[1]=function(t){return e.showServiceInfo=t}),"close-on-click-overlay":!0,"overlay-style":{"background-color":"rgba(0,0,0,.4)"}},{default:Object(c["O"])((function(){return[Q,Object(c["i"])("div",W,[(Object(c["w"])(!0),Object(c["h"])(c["a"],null,Object(c["C"])(e.serviceInfoList,(function(t){return Object(c["w"])(),Object(c["h"])("div",{key:t.type_name,class:"border-top-1px mt2x"},[t.service_info.length?(Object(c["w"])(),Object(c["h"])("div",Y,[Object(c["k"])(Object(c["H"])(t.type_name)+" ",1),Object(c["i"])("a",{href:t.service_url,class:"service-url"},te,8,Z)])):Object(c["g"])("",!0),(Object(c["w"])(!0),Object(c["h"])(c["a"],null,Object(c["C"])(t.service_info,(function(i){return Object(c["w"])(),Object(c["h"])("div",{key:i.service_goods_id,class:"options-group",onClick:function(c){return e.selectService(t,i)}},[Object(c["i"])("div",ce,[Object(c["i"])("div",{class:Object(c["r"])(["option-item border-1px",{on:i.sel_status}])},[Object(c["i"])("p",null,Object(c["H"])(i.service_short_name)+" "+Object(c["H"])(i.service_price)+"元",1)],2)])],8,ie)})),128))])})),128))]),Object(c["i"])("div",se,[Object(c["i"])("div",ne,Object(c["H"])(e.serviceSelectMessage),1),Object(c["i"])("div",{class:"btn",onClick:t[0]||(t[0]=function(){return e.serviceSelectSubmit&&e.serviceSelectSubmit.apply(e,arguments)})},"确定")])]})),_:1},8,["value","overlay-style"])])])])}Object(c["x"])();var oe=i("5530"),re=(i("159b"),i("b0c0"),i("c740"),i("a434"),i("7db0"),i("96eb")),le=i.n(re),ue=le.a.mock({status:200,message:"ok",description:"success",data:{items:[{goodsId:"2181100015",image_url:"//i1.mifile.cn/a1/pms_1522318330.86967810!180x1800.jpg",buy_limit:5,sel_status:0,product_name:"小米电视4C 50英寸 黑色 50英寸",price:1999,num:1,service_info:[{can_multi:!1,type_name:"会员服务",service_url:"//cdn.cnbj0.fds.api.mi-img.com/b2c-data-mishop/72d5bc482304.html",service_info:[{service_goods_id:"2182000044",service_image_url:"//i1.mifile.cn/a1/T1TexjBsKT1RXrhCrK.jpg",service_short_name:"影视会员年卡",service_price:299,sel_status:0,num:1}]},{can_multi:!1,type_name:"安装服务",service_url:"//cdn.cnbj0.fds.api.mi-img.com/b2c-data-mishop/a739137749cc.html",service_info:[{service_goods_id:"81000020071102471X",service_image_url:"//i1.mifile.cn/a1/pms_1523433952.48583019.jpg",service_short_name:"电视座装服务",service_price:80,sel_status:0,num:1},{service_goods_id:"990000197006122668",service_image_url:"//i1.mifile.cn/a1/pms_1523434179.92866217.jpg",service_short_name:"电视挂装服务",service_price:190,sel_status:0,num:1}]}]},{goodsId:"630000199612247492",image_url:"//i1.mifile.cn/a1/pms_1527060176.9632373!180x1800.jpg",buy_limit:5,sel_status:1,price:1299,product_name:"小米电视4X 55英寸 黑色 55英寸",num:1,service_info:[{can_multi:!1,type_name:"会员服务",service_url:"//cdn.cnbj0.fds.api.mi-img.com/b2c-data-mishop/72d5bc482304.html",service_info:[{service_goods_id:"2182000044",service_image_url:"//i1.mifile.cn/a1/T1TexjBsKT1RXrhCrK.jpg",service_short_name:"影视会员年卡",service_price:299,sel_status:0,num:1}]},{can_multi:!1,type_name:"安装服务",service_url:"//cdn.cnbj0.fds.api.mi-img.com/b2c-data-mishop/a739137749cc.html",service_info:[{service_goods_id:"81000020071102471X",service_image_url:"//i1.mifile.cn/a1/pms_1523433952.48583019.jpg",service_short_name:"电视座装服务",service_price:80,sel_status:1,num:1},{service_goods_id:"990000197006122668",service_image_url:"//i1.mifile.cn/a1/pms_1523434179.92866217.jpg",service_short_name:"电视挂装服务",service_price:190,sel_status:0,num:1}]}]},{goodsId:"330000197302099463",image_url:"//i1.mifile.cn/a1/pms_1524621084.0039673!180x1800.jpg",buy_limit:2,sel_status:0,product_name:"小米6X 全网通版 4GB内存 64GB 流沙金",price:1599,num:1,service_info:[{can_multi:!1,type_name:"保障服务",service_url:"//cdn.cnbj0.fds.api.mi-img.com/b2c-data-mishop/4a15d767c1fe.html",service_info:[{service_goods_id:"650000197903152244",service_image_url:"//i1.mifile.cn/a1/pms_1524032278.1757986.jpg",service_short_name:"意外保障服务",service_price:179,sel_status:0,num:1}]}],gift:[{product_name:"小米蓝牙耳机青春版 白色",image_url:"//i1.mifile.cn/a1/pms_1478248761.54944181.jpg",actId:"820000200604066342"}]},{goodsId:"340000198205095723",image_url:"//i1.mifile.cn/a1/pms_1524621078.90015819!180x1800.jpg",buy_limit:2,sel_status:1,product_name:"",price:1599,num:2,service_info:[{can_multi:!1,type_name:"保障服务",service_url:"//cdn.cnbj0.fds.api.mi-img.com/b2c-data-mishop/4a15d767c1fe.html",service_info:[{service_goods_id:"650000197903152244",service_image_url:"//i1.mifile.cn/a1/pms_1524032278.1757986.jpg",service_short_name:"意外保障服务",service_price:179,sel_status:0,num:1}]}],gift:[{product_name:"小米蓝牙耳机青春版 白色",image_url:"//i1.mifile.cn/a1/pms_1478248761.54944181.jpg",actId:"460000199402246828"}]}]}}),de={code:0,description:"success",result:"ok"},fe=(le.a.mock(de),le.a.mock(de),le.a.mock(de),le.a.mock(de),le.a.mock(de),i("4d1a")),_e=i("4e6d"),ve=i("2166"),be=i("5502"),pe={components:{MiPop:fe["a"],MiRecommend:_e["a"]},data:function(){return{cartList:null,serviceInfoList:null,showServiceInfo:!1,serviceSelectMessage:"请选择服务类型",serviceSelectCashArr:[],serviceSelectCashItem:null,totalNumber:0,totalPrice:0}},watch:{cartList:{deep:!0,handler:function(e){var t=0,i=0,c=0;e.forEach((function(e){e.sel_status&&(i+=e.num,e.price&&(c+=e.num*e.price)),t+=e.num})),this.totalNumber=i,this.totalPrice=c,this.setCartCount(t)}}},computed:Object(oe["a"])({},Object(be["c"])(["isLogin"])),beforeRouteEnter:function(e,t,i){t.name?Object(ve["d"])().then((function(e){i((function(t){return t.setCartList(e)}))})):i((function(e){return e.fetchCartList()}))},methods:Object(oe["a"])(Object(oe["a"])({},Object(be["d"])({setCartCount:"cart/setCount"})),{},{fetchCartList:function(){var e=this;Object(ve["d"])().then((function(t){e.setCartList(t)}))},setCartList:function(e){this.$NProgress.done(),this.$store.commit("setViewLoading",!1);var t=JSON.parse(JSON.stringify(ue)).data.items,i=[];t.forEach((function(e){e.service_info&&(e.serviceList=[],e.service_info.forEach((function(t){t.service_info.forEach((function(t){t.sel_status?e.sel_status&&i.push(Object(oe["a"])(Object(oe["a"])({},t),{},{parent_goodsId:e.goodsId})):e.serviceList.push(t)}))})))})),i.forEach((function(e){var i=t.findIndex((function(t){return t.goodsId===e.parent_goodsId}));t.splice(i+1,0,{goodsId:e.service_goods_id,image_url:e.service_image_url,num:e.num,buy_limit:t[i].num,price:e.service_price,product_name:e.service_short_name,sel_status:1,parent_goodsId:e.parent_goodsId,isService:!0})}));var c=[];t.forEach((function(e){e.sel_status&&e.gift&&e.gift.forEach((function(t){c.push(Object(oe["a"])(Object(oe["a"])({},t),{},{parent_goodsId:e.goodsId}))}))})),c.forEach((function(e){var i=t.findIndex((function(t){return t.goodsId==e.parent_goodsId}));t.splice(i+1,0,{buy_limit:t[i].num,goodsId:e.actId,image_url:e.image_url,num:t[i].num,product_name:e.product_name,sel_status:1,parent_goodsId:e.parent_goodsId,isGift:!0})})),this.cartList=t,console.log(t)},cartSelect:function(e,t){var i=this,c=e.sel_status?0:1;Object(ve["e"])({goodsId:e.goodsId,select_status:c}).then((function(s){if(200===s.status)if(e.sel_status=c,e.sel_status)e.gift&&e.gift.length&&e.gift.forEach((function(c){i.cartList.splice(t+1,0,{buy_limit:e.num,goodsId:c.actId,image_url:c.image_url,num:e.num,product_name:c.product_name,sel_status:1,parent_goodsId:e.goodsId,isGift:!0})}));else{var n=i.cartList.findIndex((function(t){return t.parent_goodsId===e.goodsId}));while(n>-1)i.cartList.splice(n,1),n=i.cartList.findIndex((function(t){return t.parent_goodsId===e.goodsId}));e.service_info.forEach((function(t){t.service_info.forEach((function(t){t.sel_status&&(t.sel_status=0,e.serviceList.push(t))}))}))}}))},cartEdit:function(e,t){var i=this;if(!(t<0&&1===e.num)&&!(t>0&&e.num==e.buy_limit)){var c=t>0?2:1;Object(ve["c"])({goodsId:e.goodsId,consumption:c}).then((function(c){c&&200===c.status&&(e.num+=t,i.cartList.forEach((function(t){t.parent_goodsId===e.goodsId&&(t.buy_limit=e.num,t.isGift&&(t.num=e.num))})))}))}},toCartSelService:function(e){this.showServiceInfo=!0;var t=[];e.service_info.forEach((function(e,i){var c=JSON.parse(JSON.stringify(e));c.service_info=[],e.service_info.forEach((function(e){e.sel_status||c.service_info.push(e)})),t.push(c)})),this.serviceInfoList=t,this.serviceSelectCashItem=e},selectService:function(e,t){t.sel_status?t.sel_status=0:(e.service_info.forEach((function(e){e.sel_status=0})),t.sel_status=1);var i=[];this.serviceInfoList.forEach((function(e){e.service_info.forEach((function(e){e.sel_status&&i.push(e)}))})),this.serviceSelectMessage=i.length?"已选择".concat(i.length,"项服务"):"请选择服务类型",this.serviceSelectCashArr=i},serviceSelectSubmit:function(){var e=this,t=this.serviceSelectCashItem;Object(ve["f"])({parent_goodsId:t.parent_goodsId,service_goods_id:t.goodsId,sel_status:1}).then((function(i){if(200===i.status){var c=e.serviceSelectCashArr;c.length&&c.forEach((function(i){var c=t.serviceList.findIndex((function(e){return e.service_goods_id===i.service_goods_id}));t.serviceList.splice(c,1),t.service_info.forEach((function(e){e.service_info.forEach((function(e){e.service_goods_id===i.service_goods_id&&(e.sel_status=1)}))}));var s=e.cartList.findIndex((function(e){return e.goodsId===t.goodsId}));e.cartList.splice(s+1,0,{buy_limit:t.num,goodsId:i.service_goods_id,image_url:i.service_image_url,num:i.num,price:i.service_price,product_name:i.service_short_name,sel_status:1,parent_goodsId:t.goodsId,isService:!0})})),e.showServiceInfo=!1}}))},cartDelete:function(e,t){var i=this;Object(ve["b"])({goodsId:e.goodsId}).then((function(c){if(i.cartList.splice(t,1),e.parent_goodsId){var s=i.cartList.find((function(t){return t.goodsId===e.parent_goodsId}));s.service_info.forEach((function(t){t.service_info.forEach((function(t){t.service_goods_id===e.goodsId&&(t.sel_status=0,s.serviceList.push(t))}))}))}else{var n=i.cartList.findIndex((function(t){return t.parent_goodsId===e.goodsId}));while(n>-1)i.cartList.splice(n,1),n=i.cartList.findIndex((function(t){return t.parent_goodsId===e.goodsId}))}}))}})},me=(i("f0fe"),i("d959")),je=i.n(me);const Oe=je()(pe,[["render",ae],["__scopeId","data-v-23236370"]]);t["default"]=Oe}}]);
//# sourceMappingURL=cart.f68032d1.js.map